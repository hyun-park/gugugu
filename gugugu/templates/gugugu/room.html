{% extends 'base.html' %}
{% load static %}
{% load i18n %}

{% block title %}
	GUGUGU
{% endblock %}

{% block head %}
	<meta name="description" content="오픈 채팅방에 참여해보세요!">
	<link rel="stylesheet" href="{% static 'gugugu/css/room.css' %}">
	<link rel="stylesheet" href="{% static 'css/nav.css' %}">
{% endblock %}

{% block body %}
	{% include 'nav.html' %}
	<canvas id="canvas-background" class="bg-dark"> </canvas>
	<img id="logo-shadow" src="{% static 'img/logo-big-shadow.png' %}">
	<div class="position-relative">
		<div class="hero w-100 d-flex flex-column justify-content-center">
			<div class="mt-auto mb-auto text-center">
				<img class="index-logo d-inline-block" src="{% static 'img/logo-bubble.png' %}">
				<div class="mt-2">
					<h5 class="text-white mt-3">{{ room.name }}</h5>
					<h3 class="text-white font-weight-bold">{% trans "Welcome, " %}{{ member.name }}</h3>
				</div>
			</div>
		</div>
		<div id="message-wrapper" class="m-3">
			{% for message in messages %}
			<div class="card mt-2">
				<div class="card-body">
					<h5 class="card-title">{{ message.member.name }}</h5>
					<p class="card-text">{{ message.text }}</p>
				</div>
			</div>
			{% endfor %}
		</div>
	</div>
	<div id="message-form-wrapper" class="fixed-bottom bg-white">
			<form id="message" method="post">
				{% csrf_token %}
				{{ message_form }}
				<input id="message-form-submit" type="submit">
			</form>
	</div>
{% endblock %}

{% block body_script %}
	<script src="{% static 'vendor/granim.min.js' %}"></script>
	<script src="{% static 'gugugu/js/index.js' %}"></script>
	<script>
      jQuery(window).ready(function() {
          let formWrapper = $("#message-form-wrapper");
          console.log(formWrapper.height() + 'px');
          $("#message-wrapper").css('padding-bottom', formWrapper.height() + 'px');

          formWrapper.change(function() {
              $("#message-wrapper").css('padding-bottom', formWrapper.height() + 'px');
          });

          $("#id_message-text").keydown(function(e){
              if (e.keyCode === 13 && !e.shiftKey && !e.ctrlKey && !e.altKey) {
                  e.preventDefault();
                  $("#message-form-submit").click()
                  return false;
              }
          });
      });
	</script>
{% endblock %}
